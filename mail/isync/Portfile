# $Id: Portfile 69520 2010-07-08 20:19:52Z jmr@macports.org $

PortSystem          1.0

name                isync
version             1.0.5
revision        1
categories          mail
platforms           darwin
maintainers         nomaintainer
description         Synchronize a maildir with an imap server
homepage            http://isync.sourceforge.net/

long_description    isync is a command line utility for synchronizing a \
                    remote IMAP mailbox with a local maildir-style mailbox. \
                    This is useful for working in disconnected mode, such as \
                    on a laptop. Modifications made locally and remotely are \
                    synchronized so that no message status flags are lost.

master_sites        sourceforge

checksums           md5     6a47b0b620ef61d4158e4f1b968ffb0f \
                    sha1    9d19cde13b644d6e394f06d292b60503396d0500 \
                    rmd160  180607a0633108ad59ea5a51d15b1f3c74b56a9a

depends_lib         port:db53 port:openssl port:zlib 

post-patch {
    reinplace "s|ldb|ldb-5.3|g" \
        ${worksrcpath}/src/compat/Makefile.in \
        ${worksrcpath}/src/compat/Makefile.am \
        ${worksrcpath}/src/Makefile.in \
        ${worksrcpath}/src/Makefile.am
}

variant async description {Experimental async branch} {
    patchfiles async.patch
    depends_lib-append port:p5-timedate
    use_autoreconf      yes
    configure.compiler macports-gcc-4.7
    # autoreconf.cmd      ./autogen.sh
}

variant recursiveimap description {Adds support for imap subfolders} {
    post-patch {
        reinplace "s|%s%%|%s\*|" ${worksrcpath}/src/drv_imap.c
    }
}

configure.args      --mandir=${prefix}/share/man
configure.cppflags-append   -I${prefix}/include/db53
configure.ldflags-append    -L${prefix}/lib/db53
